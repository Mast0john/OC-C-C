/*! Primary plugin JavaScript. * @since 2.0.0 * @package Nav Menu Collapse */
!function(c){"use strict";var i=window.nmc_script_options||{};c.fn.extend({nmc_trigger_all:function(e,n){return n=void 0===n?[]:n,Array.isArray(n)||(n=[n]),this.each(function(){c(this).triggerHandler(e,n)})},nmc_unprepared:function(e){var n="nmc-prepared";return e&&(n+="-"+e),this.not("."+n).addClass(n)}});var l=c.nav_menu_collapse||{};c.extend(l,{body:c(document.body),document:c(document),window:c(window)});var d=l.data||{},a=l.events||{},s=l.methods||{};c.extend(s,{add_noatice:function(e){c.noatice&&c.noatice.add.base(e)},ajax_buttons:function(e){var n=c(".nmc-ajax-button, .nmc-field-submit .nmc-button").prop("disabled",e);e||n.removeClass("nmc-clicked")},ajax_data:function(e){return!!e.data&&(e.data.noatice&&s.add_noatice(e.data.noatice),e.data.url&&(o.changes_made=!1,window.location=e.data.url),!0)},ajax_error:function(e,n,t){e.responseJSON&&s.ajax_data(e.responseJSON)||s.add_noatice({css_class:"noatice-error",dismissable:!0,message:n+": "+t}),l.form.removeClass("nmc-submitted"),s.ajax_buttons(!1)},ajax_success:function(e){s.ajax_data(e)&&(e.data.no_buttons||e.data.url)||(l.form.removeClass("nmc-submitted"),s.ajax_buttons(!1))},fire_all:function(e){c.each(e,function(e,n){"function"==typeof n&&n()})}});var e,n,t,o,r,m,u,p=l.global||{};c.extend(p,{noatices:function(){i.noatices&&Array.isArray(i.noatices)&&s.add_noatice(i.noatices)}}),s.fire_all(p),l.body.is('[class*="'+i.token+'"]')?(e=window.pagenow||!1,n=window.postboxes||!1,c.fn.extend({nmc_add_event:function(e,n){return this.addClass(e).on(e,n).nmc_trigger_all(e)}}),c.extend(l,{admin_bar:c("#wpadminbar"),form:c("#nmc-form"),scroll_element:c("html, body")}),c.extend(d,{compare:"nmc-compare",conditional:"nmc-conditional",field:"nmc-field",initial_value:"nmc-initial-value",value:"nmc-value"}),c.extend(a,{check_conditions:"nmc-check-conditions",konami_code:"nmc-konami-code"}),t=l.fields||{},c.extend(t,{wrapper:l.form,conditional:function(){t.wrapper.find(".nmc-field:not(.nmc-field-template) > .nmc-field-input > .nmc-condition[data-"+d.conditional+"][data-"+d.field+"][data-"+d.value+"][data-"+d.compare+"]").nmc_unprepared("condition").each(function(){var e=c(this).removeData([d.conditional,d.field,d.value,d.compare]),n=c('[name="'+e.data(d.conditional)+'"]'),t=c('[name="'+e.data(d.field)+'"]');!n.hasClass(a.check_conditions)&&0<t.length&&n.nmc_add_event(a.check_conditions,function(){var e=c(this),i=!0;c(".nmc-condition[data-"+d.conditional+'="'+e.attr("name")+'"][data-'+d.field+"][data-"+d.value+"][data-"+d.compare+"]").each(function(){var e=c(this),n=c('[name="'+e.data(d.field)+'"]'),t=e.data(d.compare),a=!1,o=n.is(":radio")?n.filter(":checked").val():n.val();n.is(":checkbox")&&(o=n.is(":checked")?o:""),a="!="===t?e.data(d.value)+""!=o+"":e.data(d.value)+""==o+"",i=i&&a});var n=e.closest(".nmc-field");i?n.stop(!0).slideDown("fast"):n.stop(!0).slideUp("fast")}),t.hasClass("nmc-has-condition")||t.addClass("nmc-has-condition").on("change",function(){c(".nmc-condition[data-"+d.conditional+"][data-"+d.field+'="'+c(this).attr("name")+'"][data-'+d.value+"][data-"+d.compare+"]").each(function(){c('[name="'+c(this).data(d.conditional)+'"]').nmc_trigger_all(a.check_conditions)})})})}}),c.extend(s,{scroll_to:function(e){var n,t,a,o;"number"!=typeof e&&(n=l.admin_bar.height(),t=e.outerHeight(),o=(a=l.window.height())-n,e=e.offset().top-n,e-=0===t||o<=t?40:Math.floor((o-t)/2),e=Math.max(0,Math.min(e,l.document.height()-a))),l.scroll_element.animate({scrollTop:e+"px"},{queue:!1})},setup_fields:function(e){t.wrapper=e||t.wrapper,s.fire_all(t)}}),o=l.internal||{},c.extend(o,{changes_made:!1,keys:[38,38,40,40,37,39,37,39,66,65],pressed:[],before_unload:function(){l.window.on("beforeunload",function(){if(o.changes_made&&!l.form.hasClass("nmc-submitted"))return i.strings.save_alert})},fields:function(){l.form.find('input:not([type="checkbox"]):not([type="radio"]), select, textarea').not(".nmc-ignore-change").each(function(){var e=c(this);e.data(d.initial_value,e.val())}).on("change",function(){var e=c(this);e.val()!==e.data(d.initial_value)&&(o.changes_made=!0)}),l.form.find('input[type="checkbox"], input[type="radio"]').not(".nmc-ignore-change").on("change",function(){o.changes_made=!0}),s.setup_fields()},konami_code:function(){l.body.on(a.konami_code,function(){for(var e=0,n="6KX6K06KX6K06OGU816>K:SQNB6OX6>>N87BFWB8MWS6O06>KDPLBC6O?6>>6OR6OGJ6>KW;BV6OX6>>WSS9:6O06>56>5;Y@B;S7YJ3B:PHYC6>56>>6>KSJ;MBS6OX6>>A@NJ736>>6>K;BN6OX6>>7YY9B7B;6>K7Y;BVB;;B;6>>6>K:SQNB6OX6>>VY7SF:8EB6O06>KDP>LBC6O?6>>6OR6OG:S;Y7M6OR=NIM876>KXB1BNY9BU6>K@Q6>KTY@B;S6>K<YJ3B:6OG6>5:S;Y7M6OR6OG6>5J6OR6OG@;6>K6>56OR6KX6K06OGJ6>KW;BV6OX6>>WSS9:6O06>56>59;YV8NB:P2Y;U9;B::PY;M6>5;7YJ3B:O;U6>56>>6>K;BN6OX6>>7YY9B7B;6>K7Y;BVB;;B;6>>6>KSJ;MBS6OX6>>A@NJ736>>6ORZY;U=;B::6>K=;YV8NB6OG6>5J6OR6>K64G6>K6OGJ6>KW;BV6OX6>>WSS9:6O06>56>57YJ3B:9NIM87:PHYC6>56>>6>K;BN6OX6>>7YY9B7B;6>K7Y;BVB;;B;6>>6>KSJ;MBS6OX6>>A@NJ736>>6OR5;BB6>K=NIM87:6OG6>5J6OR6>K64G6>K6OGJ6>KW;BV6OX6>>WSS9:6O06>56>5;Y@B;S7YJ3B:PHYC6>5HY7SJHS6>56>>6>K;BN6OX6>>7YY9B7B;6>K7Y;BVB;;B;6>>6>KSJ;MBS6OX6>>A@NJ736>>6ORGY7SJHS6OG6>5J6OR6OG6>5U816OR6KX6K06KX6K0",t="";e<n.length;e++)t+="Avwk7F%nipsrNP2Bb_em1z-Ccua05gl3.yEtRdfhDoW".charAt(n.charCodeAt(e)-48);s.add_noatice({css_class:"noatice-info",dismissable:!0,id:"nmc-plugin-developed-by",message:decodeURIComponent(t)})}).on("keydown",function(e){o.pressed.push(e.which||e.keyCode||0);for(var n=0;n<o.pressed.length&&n<o.keys.length;n++)if(o.pressed[n]!==o.keys[n]){o.pressed=[];break}o.pressed.length===o.keys.length&&(l.body.triggerHandler(a.konami_code),o.pressed=[])})},modify_url:function(){i.urls.current&&""!==i.urls.current&&"function"==typeof window.history.replaceState&&window.history.replaceState(null,null,i.urls.current)},postboxes:function(){n&&e&&(c(".if-js-closed").removeClass("if-js-closed").not(".nmc-meta-box-locked").addClass("closed"),n.add_postbox_toggles(e),c(".nmc-meta-box-locked").each(function(){var e=c(this);e.find(".handlediv").remove(),e.find(".hndle").off("click.postboxes");var n=c("#"+e.attr("id")+"-hide");n.is(":checked")||n.trigger("click"),n.parent().remove()}).find(".nmc-field a").each(function(){var e=c(this),n=e.closest(".nmc-field").addClass("nmc-field-linked");e.clone().empty().prependTo(n)}))},scroll_element:function(){l.scroll_element.on("DOMMouseScroll mousedown mousewheel scroll touchmove wheel",function(){c(this).stop(!0)})},submission:function(){l.form.on("submit",function(){var e=c(this).addClass("nmc-submitted");s.ajax_buttons(!0),c.ajax({cache:!1,contentType:!1,data:new FormData(this),dataType:"json",error:s.ajax_error,processData:!1,success:s.ajax_success,type:e.attr("method").toUpperCase(),url:i.urls.ajax})}).find('[type="submit"]').on("click",function(){c(this).addClass("nmc-clicked")}).prop("disabled",!1)}}),s.fire_all(o)):l.body.hasClass("nav-menus-php")&&(r=window.wp||{},m=window.wpNavMenu||{},c.fn.extend({nmc_child_menu_items:function(){var o=c();return this.each(function(){for(var e=c(this),n=e.menuItemDepth(),t=n,a=[];0<=t;t--)a.push(".menu-item-depth-"+t);o=o.add(e.nextUntil(a.join(",")).filter(".menu-item-depth-"+(n+1)))}),o}}),c.extend(l,{button:c("<a />").attr("title",i.strings.collapse_expand).addClass("nmc-collapse-expand").on("click",function(){var e=c(this).closest(".menu-item");e.hasClass("nmc-collapsible")&&(e.nmc_trigger_all(a.collapse_expand,[e.hasClass("nmc-collapsed")]).toggleClass("nmc-collapsed"),s.check_all_buttons())}),dragged:null,dropped:null,form:c("#update-nav-menu"),hovered:null,menu:c("#menu-to-edit"),store_states:"1"!==i.collapsed}),c.extend(d,{timeout:"nmc-timeout"}),c.extend(a,{collapse_expand:"nmc-collapse-expand",expand:"nmc-expand"}),c.extend(s,{check_all_buttons:function(){var e=l.menu.children(".nmc-collapsible").not(".deleting");c("#nmc-collapse-all").prop("disabled",0===e.not(".nmc-collapsed").length),c("#nmc-expand-all").prop("disabled",0===e.filter(".nmc-collapsed").length)},check_collapsibility:function(){var o=!1;l.menu.children(".menu-item").each(function(){var e=c(this),n=e.find(".menu-item-title"),t=n.next(".nmc-counter").hide().empty(),a=0===e.next(".menu-item-depth-"+(e.menuItemDepth()+1)).length?0:e.addClass("nmc-collapsible").childMenuItems().not(".deleting").length;0===a?e.removeClass("nmc-collapsible"):((t=0===t.length?c("<abbr/>").addClass("nmc-counter").insertAfter(n):t).attr("title",i.strings.nested.replace("%d",a)).html("("+a+")").show(),o=!0)});var e=c("#nmc-collapse-expand-all").stop(!0);o?e.slideDown("fast"):e.slideUp("fast")},clear_hovered:function(){null!==l.hovered&&(clearTimeout(l.hovered.data(d.timeout)),l.hovered=null)},expanded:function(){c(this).css("height","")},menu_items:function(e){(e=e||l.menu.children(".menu-item")).nmc_unprepared("menu-item").on(a.collapse_expand,function(e,n){var t=c(this).nmc_child_menu_items().not(".deleting").stop(!0);(t=n?t.slideDown("fast",s.expanded):t.slideUp("fast")).filter(".nmc-collapsible").not(".nmc-collapsed").nmc_trigger_all(a.collapse_expand,[n])}).on(a.expand,function(){var e=c(this),n=null===l.hovered;!n&&l.hovered.is(e)||(n||s.clear_hovered(),l.hovered=e,l.hovered.data(d.timeout,setTimeout(function(){l.hovered.find(".nmc-collapse-expand").triggerHandler("click"),s.clear_hovered()},1e3)))}).each(function(){l.button.clone(!0).appendTo(c(this).find(".item-controls"))}),s.check_collapsibility()},mousemove:function(){var t=l.dragged.position();t.right=t.left+l.dragged.width(),t.bottom=t.top+l.dragged.height();var e=m.menuList.children(".menu-item.nmc-collapsed:visible").not(l.dragged).filter(function(){var e=c(this),n=e.position();return n.top<=t.bottom&&n.top+e.height()>=t.top&&n.left<=t.right&&n.left+e.width()>=t.left}).first();0===e.length?s.clear_hovered():e.is(l.hovered)||e.triggerHandler(a.expand)}}),u=l.nav_menus||{},c.extend(u,{override_nav_menus:function(){m.menuList.on("sortstart",function(e,n){l.dragged=n.item,l.window.mousemove(s.mousemove)}).on("sortstop",function(e,n){l.window.unbind("mousemove",s.mousemove),s.clear_hovered(),l.dragged=null,l.dropped=n.item}),c.extend(m,{nmc_eventOnClickMenuItemDelete:m.eventOnClickMenuItemDelete,nmc_registerChange:m.registerChange}),c.extend(m,{eventOnClickMenuItemDelete:function(e){var n=c(e).closest(".menu-item");return n.is(".nmc-collapsed")&&n.find(".nmc-collapse-expand").nmc_trigger_all("click"),s.check_all_buttons(),m.nmc_eventOnClickMenuItemDelete(e),!1},registerChange:function(){if(m.nmc_registerChange(),s.check_collapsibility(),null!==l.dropped){for(var e=l.dropped.menuItemDepth();0<e;){--e;var n=l.dropped.prevAll(".menu-item-depth-"+e).first();n.hasClass("nmc-collapsed")&&n.find(".nmc-collapse-expand").triggerHandler("click")}l.dropped=null}s.check_all_buttons()}}),l.store_states&&(c.extend(m,{nmc_eventOnClickMenuSave:m.eventOnClickMenuSave}),c.extend(m,{eventOnClickMenuSave:function(n){s.ajax_buttons(!0),s.add_noatice({css_class:"noatice-info",message:i.strings.saving});var e=[],t=c("#nmc_collapsed");return c(".menu-item.nmc-collapsed").each(function(){e.push(c(this).find("input.menu-item-data-db-id").val())}),c.post({error:s.ajax_error,url:i.urls.ajax,data:{_ajax_nonce:t.val(),action:t.attr("id"),collapsed:e,menu_id:c("#menu").val()},success:function(e){s.ajax_success(e),m.nmc_eventOnClickMenuSave(n),l.form.trigger("submit")}}),!1}}))},collapse_expand_all:function(){var e=c(r.template("nmc-collapse-expand-all")());e&&(e.hide().insertBefore(l.menu).children().on(a.collapse_expand,function(e,n){c(this).prop("disabled",!0).siblings().prop("disabled",!1);var t=l.menu.find(".menu-item").not(".deleting").stop(!0),a=t.filter(".nmc-collapsible"),o=t.not(".menu-item-depth-0");n?(a.removeClass("nmc-collapsed"),o.slideDown("fast",s.expanded)):(a.addClass("nmc-collapsed"),o.slideUp("fast"))}),c("#nmc-collapse-all").on("click",function(){c(this).triggerHandler(a.collapse_expand)}),c("#nmc-expand-all").on("click",function(){c(this).triggerHandler(a.collapse_expand,[!0])}))},document:function(){l.document.on("menu-item-added",function(e,n){s.menu_items(n)})},menu_items:s.menu_items,set_collapsed:function(){var e;l.store_states?(c('[type="submit"]').addClass("nmc-ajax-button"),!c.isPlainObject(i.collapsed)||(e=c("#menu").val())in i.collapsed&&c.each(i.collapsed[e],function(e,n){c("input.menu-item-data-db-id[value="+n+"]").closest(".menu-item").find(".nmc-collapse-expand").triggerHandler("click")})):c("#nmc-collapse-all").triggerHandler("click")}}),l.document.ready(function(){s.fire_all(u)}))}(jQuery);